var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),BaseFruit=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.img=new egret.Bitmap,this.img_part1=new egret.Bitmap,this.img_part2=new egret.Bitmap,this.addChild(this.img),this.accelerateX=0,this.accelerateY=700,this.accelerateRotate=0,this.speedX=180*(Math.random()-.5),this.speedY=-700,this.speedRotate=360*(Math.random()-.5),this.x=this.initX=400*Math.random()+180,this.y=this.initY=530,this.addEventListener(egret.Event.ENTER_FRAME,this.freeFalling,this),this.beginTime=egret.getTimer(),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cutFruit,this),this.cutIndex=!1},e.prototype.freeFalling=function(t){var e=(egret.getTimer()-this.beginTime)/1e3;this.x=this.initX+e*this.speedX,this.y=this.speedY*e+.5*this.accelerateY*e*e+this.initY,this.img.rotation=e*this.speedRotate,this.y>530&&!this.cutIndex&&(this.addFailed(),this.cutIndex=!0)},e.prototype.setSize=function(){this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.img.anchorOffsetX=this.img.width/2,this.img.anchorOffsetY=this.img.height/2,this.img_part1.anchorOffsetX=this.img.width/2,this.img_part1.anchorOffsetY=this.img.height/2,this.img_part2.anchorOffsetX=this.img.width/2,this.img_part2.anchorOffsetY=this.img.height/2},e.prototype.cutFruit=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.cutFruit,this),this.cutIndex=!0,this.splitEffect(),this.addCutSound(),this.cutEffect(),this.splashEffectFun(),this.addScore()},e.prototype.splitEffect=function(){this.splitBitmap=new egret.Bitmap,this.splitBitmap.texture=RES.getRes("flash_png"),this.splitBitmap.anchorOffsetX=this.splitBitmap.width/2,this.splitBitmap.anchorOffsetY=this.splitBitmap.height/2,this.splitBitmap.x=this.img.x,this.splitBitmap.y=this.img.y,this.splitBitmap.scaleX=.8,this.splitBitmap.scaleY=.8,this.splitBitmap.alpha=0,this.addChild(this.splitBitmap),egret.Tween.get(this.splitBitmap).to({alpha:1},100).to({alpha:0},100).call(function(){this.removeChild(this.splitBitmap),this.splitBitmap=null},this)},e.prototype.addCutSound=function(){var t=RES.getRes("splatter_mp3");t.play(0,1)},e.prototype.cutEffect=function(){this.removeChild(this.img),this.addChild(this.img_part1),this.addChild(this.img_part2),this.addEventListener(egret.Event.ENTER_FRAME,this.cutFreeFalling,this)},e.prototype.splashEffectFun=function(){if(this.splashColor){this.splashEffect=new SplashEffect(this.splashColor);this.splashEffect.x=this.x-35,this.splashEffect.y=this.y-35;this.parent.addChild(this.splashEffect),egret.setTimeout(function(){this.parent.removeChild(this.splashEffect)},this,400)}},e.prototype.cutFreeFalling=function(){this.img_part1.x-=2,this.img_part2.x+=2,this.img_part1.rotation-=2,this.img_part2.rotation+=2},e.prototype.addScore=function(){Observer.getInstance().fire(Commands.ADD_SCORE)},e.prototype.addFailed=function(){var t=this,e=new egret.Bitmap;e.texture=RES.getRes("lose_png"),e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.scaleX=0,e.scaleY=0,e.x=this.x-this.width/2,e.y=430,this.parent.addChild(e);egret.Tween.get(e).to({scaleX:1.1,scaleY:1.1},600,egret.Ease.backOut).wait(600).call(function(){t.parent.removeChild(e)});Observer.getInstance().fire(Commands.ADD_FAILED)},e}(egret.DisplayObjectContainer);__reflect(BaseFruit.prototype,"BaseFruit");var Basaha=function(t){function e(){var e=t.call(this)||this;return e.img.texture=RES.getRes("basaha_png"),e.img_part1.texture=RES.getRes("basaha-1_png"),e.img_part2.texture=RES.getRes("basaha-2_png"),e.initRotation=45,e.rotationIndex=1,e.splashColor=16711680,e.setSize(),e}return __extends(e,t),e}(BaseFruit);__reflect(Basaha.prototype,"Basaha");var Main=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isThemeLoadEnd=!1,e.isResourceLoadEnd=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.setMaxRetryTimes(6),RES.loadGroup("preload")},e.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},e.prototype.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},e.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.startCreateScene=function(){this.stage.frameRate=240,this.fruithomePage=FruitHomePage.getInstance(),this.addChild(this.fruithomePage),this.sceneManager=new SceneManager},e}(eui.UILayer);__reflect(Main.prototype,"Main");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function r(t){e.call(n,t)}function s(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var ClassName=function(){function t(){}return t.APPLE=function(){return new Apple},t.BANANA=function(){return new Banana},t.BASAHA=function(){return new Basaha},t.PEACH=function(){return new Peach},t.SANDIA=function(){return new Sandia},t.BOOM=function(){return new Boom},t}();__reflect(ClassName.prototype,"ClassName");var Commands=function(){function t(){}return t.OPEN_NEWGAME="open_newgame",t.OPEN_JODO="open_jodo",t.OPEN_QUIT="open_quit",t.CLOSE_NEWGAME="close_newgame",t.CLOSE_JODO="close_jodo",t.CLOSE_QUIT="close_quit",t.ADD_SCORE="add_score",t.ADD_FAILED="add_failed",t.GAME_OVER="game_over",t}();__reflect(Commands.prototype,"Commands");var BoomEffect=function(t){function e(e){var i=t.call(this)||this;return i.lightNum=8,i.lightRotation=[],i.lightRotationOrder=[],i.index=0,i.lightArray=[],i.fruitObj=e,i.init(),i.getLightRotation(),i.getOrder(),i.addBoomSound(),i.addLight(),i.addWhiteBg(),i}return __extends(e,t),e.prototype.init=function(){this.width=1280,this.height=960,this.anchorOffsetX=640,this.anchorOffsetY=480},e.prototype.getLightRotation=function(){for(var t=360/this.lightNum,e=0;e<this.lightNum;e++)this.lightRotation.push(Math.random()*t*.5+.25*t+t*e)},e.prototype.addBoomSound=function(){var t=RES.getRes("boom_mp3");t.play(0,1)},e.prototype.getOrder=function(){for(var t=[],e=0;e<this.lightNum;e++)t.push(this.lightRotation[e]);for(var e=8;e>0;e--){var i=Math.floor(Math.random()*e);this.lightRotationOrder.push(t[i]),t.splice(i,1)}},e.prototype.addLight=function(){if(this.timer&&egret.clearTimeout(this.timer),this.index<this.lightNum){var t=this.createLight();t.rotation=this.lightRotationOrder[this.index++],this.lightArray.push(t),this.addChild(t),this.timer=egret.setTimeout(this.addLight,this,200)}},e.prototype.createLight=function(){var t=new egret.Shape;return t.graphics.beginFill(16777193,1),t.graphics.moveTo(0,17),t.graphics.lineTo(640,0),t.graphics.lineTo(640,40),t.graphics.lineTo(0,23),t.graphics.endFill(),t.anchorOffsetX=0,t.anchorOffsetY=20,t.x=640,t.y=480,t},e.prototype.addWhiteBg=function(){var t=new egret.Shape;t.graphics.beginFill(16777215,1),t.graphics.drawRect(0,0,640,480),t.graphics.endFill(),egret.setTimeout(function(){this.stage.addChild(t);for(var e=(egret.Tween.get(t).to({alpha:0},3e3).call(function(){this.stage.removeChild(t),Observer.getInstance().fire(Commands.GAME_OVER)}),0);e<this.lightNum;e++)this.removeChild(this.lightArray[e]);GameContainer.getInstance().removeChild(this.fruitObj)},this,200*this.lightNum)},e}(egret.DisplayObjectContainer);__reflect(BoomEffect.prototype,"BoomEffect");var Effects;!function(t){function e(t,e,i){var n=function(){var i=t.y;egret.Tween.get(t).to({y:i+10},e/2,egret.Ease.circIn).to({y:i},e/2,egret.Ease.circOut).call(n,this)},r=t.y;i?egret.Tween.get(t).to({y:r+10},e/2,egret.Ease.circIn).to({y:r},e/2,egret.Ease.circOut).call(n,this):egret.Tween.get(t).to({y:r+10},e/2,egret.Ease.circIn).to({y:r},e/2,egret.Ease.circOut)}function i(t,e,i,n){var r=n?1:-1,s=function(){t.rotation=0,egret.Tween.get(t).to({rotation:360*r},e).call(s,this)};i?(t.rotation=0,egret.Tween.get(t).to({rotation:360*r},e).call(s,this)):(t.rotation=0,egret.Tween.get(t).to({rotation:360*r},e))}t.floatUpdown=e,t.rotate=i}(Effects||(Effects={}));var Scar=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.scarImage=new eui.Image,this.scarImage.source="smoke_png",this.scarImage.anchorOffsetX=this.scarImage.width/2,this.scarImage.anchorOffsetY=this.scarImage.height/2,this.addChild(this.scarImage)},e}(eui.Component);__reflect(Scar.prototype,"Scar");var Sparkle=function(t){function e(e){var i=t.call(this)||this;return i.emitterX=60,i.emitterY=60,i.emission=e,i.width=2*i.emitterX,i.height=2*i.emitterY,i.anchorOffsetX=i.emitterX,i.anchorOffsetY=i.emitterY,i.start(),i}return __extends(e,t),e.prototype.start=function(){this.sparkleTimer=new egret.Timer(this.emission,0),this.sparkleTimer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.sparkleTimer.start()},e.prototype.timerFunc=function(){this.addChild(this.creatParticle())},e.prototype.creatParticle=function(){var t=new eui.Image;t.source="flash_png",t.width=25,t.height=7,t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.x=this.emitterX,t.y=this.emitterY,t.rotation=360*Math.random();var e=t.rotation/180*Math.PI;return egret.Tween.get(t).to({x:this.emitterX*(Math.cos(e)+1),y:this.emitterX*(Math.sin(e)+1),scaleX:.2,scaleY:.2},100*(Math.random()-.5)+400).call(function(){this.parent.removeChild(this)},t),t},e}(eui.Component);__reflect(Sparkle.prototype,"Sparkle");var SplashEffect=function(t){function e(e){var i=t.call(this)||this;return i.splashColor=e,i.start(),i}return __extends(e,t),e.prototype.start=function(){for(var t=0;10>t;t++){var e=2*Math.random()+4,i=300*Math.random()+200,n=360*Math.random(),r=new Splash(e,i,n,this.splashColor);this.addChild(r)}},e}(egret.DisplayObjectContainer);__reflect(SplashEffect.prototype,"SplashEffect");var Splash=function(t){function e(e,i,n,r){var s=t.call(this)||this;s.radius=e,s.speed=i,s.direction=n,s.splashColor=r,s.init(),s.initX=s.x,s.initY=s.y;egret.Tween.get(s).to({scaleX:.5,scaleY:.5},390).call(function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.updateLocation,this)});return s.beginTime=egret.getTimer(),s.addEventListener(egret.Event.ENTER_FRAME,s.updateLocation,s),s}return __extends(e,t),e.prototype.init=function(){this.graphics.beginFill(this.splashColor,1),this.graphics.drawCircle(0,0,this.radius),this.graphics.endFill()},e.prototype.updateLocation=function(){this.x=this.initX+this.speed*(egret.getTimer()-this.beginTime)/1e3*Math.cos(this.direction/57.3),this.y=this.initY-this.speed*(egret.getTimer()-this.beginTime)/1e3*Math.sin(this.direction/57.3)},e}(egret.Shape);__reflect(Splash.prototype,"Splash");var Apple=function(t){function e(){var e=t.call(this)||this;return e.img.texture=RES.getRes("apple_png"),e.img_part1.texture=RES.getRes("apple-1_png"),e.img_part2.texture=RES.getRes("apple-2_png"),e.initRotation=-45,e.rotationIndex=0,e.splashColor=8897296,e.setSize(),e}return __extends(e,t),e}(BaseFruit);__reflect(Apple.prototype,"Apple");var Banana=function(t){function e(){var e=t.call(this)||this;return e.img.texture=RES.getRes("banana_png"),e.img_part1.texture=RES.getRes("banana-2_png"),e.img_part2.texture=RES.getRes("banana-1_png"),e.initRotation=90,e.rotationIndex=1,e.splashColor=null,e.setSize(),e}return __extends(e,t),e}(BaseFruit);__reflect(Banana.prototype,"Banana");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?n(r):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Boom=function(t){function e(){var e=t.call(this)||this;return e.img.texture=RES.getRes("boom_png"),e.setSize(),e}return __extends(e,t),e.prototype.addFailed=function(){},e.prototype.cutFruit=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.cutFruit,this),this.cutIndex=!0;var t=GameContainer.getInstance();t.timer.stop(),t.parent.removeEventListener(egret.TouchEvent.TOUCH_MOVE,t.collideDetection,t);var e=new BoomEffect(this);e.x=this.x-33,e.y=this.y-34,GameContainer.getInstance().addChild(e),GameContainer.getInstance().addChild(this),this.removeEventListener(egret.Event.ENTER_FRAME,this.freeFalling,this)},e}(BaseFruit);__reflect(Boom.prototype,"Boom");var Peach=function(t){function e(){var e=t.call(this)||this;return e.img.texture=RES.getRes("peach_png"),e.img_part1.texture=RES.getRes("peach-1_png"),e.img_part2.texture=RES.getRes("peach-2_png"),e.initRotation=-45,e.rotationIndex=0,e.splashColor=16287245,e.setSize(),e}return __extends(e,t),e}(BaseFruit);__reflect(Peach.prototype,"Peach");var Sandia=function(t){function e(){var e=t.call(this)||this;return e.img.texture=RES.getRes("sandia_png"),e.img_part1.texture=RES.getRes("sandia-1_png"),e.img_part2.texture=RES.getRes("sandia-2_png"),e.initRotation=85,e.rotationIndex=1,e.splashColor=16711680,e.setSize(),e}return __extends(e,t),e}(BaseFruit);__reflect(Sandia.prototype,"Sandia");var GameContainer=function(t){function e(){var e=t.call(this)||this;return e.moveCount=0,e.hasThrow=!1,e.prePointX=-1,e.prePointY=-1,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.timer=new egret.Timer(2100,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.popupFruit,this),this.timer.start(),egret.setTimeout(function(){this.parent.touchEnabled=!0,this.parent.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.collideDetection,this),this.parent.addEventListener(egret.TouchEvent.TOUCH_END,this.moveEnd,this)},this,2100)},e.prototype.popupFruit=function(){this.fruitNum=Math.ceil(3*Math.random()),this.fruitArray=[];for(var t=[ClassName.APPLE,ClassName.BANANA,ClassName.BASAHA,ClassName.PEACH,ClassName.SANDIA,ClassName.BOOM],e=0;e<this.fruitNum;e++){var i=t[Math.floor(6*Math.random())]();this.fruitArray.push(i),this.addChild(i)}},e.prototype.moveEnd=function(){this.prePointX=-1,this.prePointY=-1,this.moveCount=0,this.hasThrow=!1},e.prototype.collideDetection=function(t){if(this.moveCount++,!this.hasThrow&&this.moveCount>10){var e=RES.getRes("throw_mp3");e.play(0,1);this.hasThrow=!0}if(this.prePointX>0&&this.prePointY>0){var i=Math.floor(Math.sqrt((this.prePointY-t.stageY)*(this.prePointY-t.stageY)+(this.prePointX-t.stageX)*(this.prePointX-t.stageX))),n=57.3*Math.atan((t.stageY-this.prePointY)/(t.stageX-this.prePointX));if(this.prePointX>t.stageX){var r=new egret.Shape;r.graphics.lineStyle(8,14540485),r.graphics.moveTo(0,0),r.graphics.lineTo(i,0),r.graphics.endFill()}else{var r=new egret.Shape;r.graphics.lineStyle(9,14540485),r.graphics.moveTo(0,0),r.graphics.lineTo(-i,0),r.graphics.endFill()}r.x=t.stageX,r.y=t.stageY,r.anchorOffsetX=4.5,r.rotation=n,this.parent.addChild(r);egret.Tween.get(r).to({scaleY:0},300).call(function(){this.parent.removeChild(r),r=null})}for(var s=0;s<this.fruitNum;s++)if(!this.fruitArray[s].cutIndex){var a=this.fruitArray[s].hitTestPoint(t.stageX,t.stageY,!0);a&&(this.fruitArray[s].cutFruit(),this.setSplitRotation(t.stageX,t.stageY,this.fruitArray[s]))}this.prePointX=t.stageX,this.prePointY=t.stageY},e.prototype.setSplitRotation=function(t,e,i){i.splitBitmap&&(-1==this.prePointX?i.splitBitmap.rotation=0:this.prePointX==t?i.splitBitmap.rotation=90:i.splitBitmap.rotation=57.3*Math.atan((e-this.prePointY)/(t-this.prePointX)),i.img_part1.rotation=i.img_part2.rotation=i.initRotation+i.splitBitmap.rotation,i.splitBitmap.rotation<0&&(i.img_part1.rotation=i.img_part2.rotation+=180),i.img_part1.rotation=i.img_part2.rotation+=180*i.rotationIndex)},e.getInstance=function(){return void 0===this._instance&&(this._instance=new e),this._instance},e.destroyInstance=function(){this._instance=void 0},e}(egret.DisplayObjectContainer);__reflect(GameContainer.prototype,"GameContainer");var GameManager=function(){function t(){this.registObserver()}return t.prototype.registObserver=function(){Observer.getInstance().regist(Commands.ADD_SCORE,this.addScore,this),Observer.getInstance().regist(Commands.ADD_FAILED,this.addFailed,this),Observer.getInstance().regist(Commands.GAME_OVER,this.gameOver,this)},t.prototype.addScore=function(){var t=FruitNewGamePage.getInstance();t.scoreCount+=1,t.gameScore.text=String(t.scoreCount)},t.prototype.addFailed=function(){var t=FruitNewGamePage.getInstance();if(t.failedCount+=1,1==t.failedCount){egret.Tween.get(t.gameXF).to({scaleX:1,scaleY:1},200,egret.Ease.backOut)}else if(2==t.failedCount){egret.Tween.get(t.gameXXF).to({scaleX:1,scaleY:1},200,egret.Ease.backOut)}else if(3==t.failedCount){egret.Tween.get(t.gameXXXF).to({scaleX:1,scaleY:1},200,egret.Ease.backOut);Observer.getInstance().fire(Commands.GAME_OVER)}},t.prototype.gameOver=function(){var t=GameContainer.getInstance();t.timer.stop();var e=FruitNewGamePage.getInstance();egret.Tween.get(e.gameover).to({scaleX:1,scaleY:1,alpha:1},500,egret.Ease.backOut);e.once(egret.TouchEvent.TOUCH_TAP,this.quitGamePage,this)},t.prototype.quitGamePage=function(){Observer.getInstance().fire(Commands.CLOSE_NEWGAME)},t}();__reflect(GameManager.prototype,"GameManager");var Observer=function(){function t(){this._messages=[]}return t.prototype.regist=function(t,e,i){var n={fn:e,content:i};"undefined"==typeof this._messages[t]?this._messages[t]=[n]:this._messages[t].push(n)},t.prototype.fire=function(t,e){if(this._messages[t])for(var i={commandKey:t,args:e||{}},n=0;n<this._messages[t].length;n++)this._messages[t][n].fn.call(this._messages[t][n].content,i)},t.prototype.remove=function(t,e,i){var n={fn:e,content:i};if(this._messages[t]instanceof Array)for(var r=this._messages[t].length-1;r>=0;r--)this._messages[t][r]===n&&this._messages[t].splice(r,1)},t.getInstance=function(){return void 0===this._instance&&(this._instance=new t),this._instance},t}();__reflect(Observer.prototype,"Observer");var SceneManager=function(){function t(){this.registObserver()}return t.prototype.registObserver=function(){Observer.getInstance().regist(Commands.OPEN_NEWGAME,this.openNewGame,this),Observer.getInstance().regist(Commands.CLOSE_NEWGAME,this.closeNewGame,this),Observer.getInstance().regist(Commands.OPEN_JODO,this.openJodo,this),Observer.getInstance().regist(Commands.CLOSE_JODO,this.closeJodo,this),Observer.getInstance().regist(Commands.OPEN_QUIT,this.openQuit,this),Observer.getInstance().regist(Commands.CLOSE_QUIT,this.closeQuit,this)},t.prototype.openNewGame=function(){var t=FruitHomePage.getInstance();t.channelBg.stop();var e=500;this.disappearHomePage(t,e),egret.setTimeout(function(){var e=t.parent;e.removeChild(t),FruitHomePage.destroyInstance();var i=FruitNewGamePage.getInstance();e.addChild(i)},this,e+100)},t.prototype.closeNewGame=function(){var t=FruitNewGamePage.getInstance(),e=RES.getRes("over_mp3"),i=e.play(0,1),n=1e3;this.disappearNewGamePage(t,n),egret.setTimeout(function(){i.stop();var e=t.parent;e.removeChild(t),FruitNewGamePage.destroyInstance();var n=FruitHomePage.getInstance();e.addChild(n)},this,n+100)},t.prototype.openJodo=function(){var t=FruitHomePage.getInstance();t.channelBg.stop();var e=500;this.disappearHomePage(t,e),egret.setTimeout(function(){var e=t.parent;e.removeChild(t),FruitHomePage.destroyInstance();var i=FruitJodoPage.getInstance();e.addChild(i)},this,e+100)},t.prototype.closeJodo=function(){var t=FruitJodoPage.getInstance(),e=500;this.disappearJodoPage(t,e),egret.setTimeout(function(){var e=t.parent;e.removeChild(t),FruitJodoPage.destroyInstance();var i=FruitHomePage.getInstance();e.addChild(i)},this,e+100)},t.prototype.openQuit=function(){var t=FruitHomePage.getInstance();t.channelBg.stop();var e=500;this.disappearHomePage(t,e),egret.setTimeout(function(){var e=t.parent;e.removeChild(t),FruitHomePage.destroyInstance();var i=FruitQuitPage.getInstance();e.addChild(i)},this,e+100)},t.prototype.closeQuit=function(){var t=FruitQuitPage.getInstance(),e=500;this.disappearQuitPage(t,e),egret.setTimeout(function(){var e=t.parent;e.removeChild(t),FruitQuitPage.destroyInstance();var i=FruitHomePage.getInstance();e.addChild(i)},this,e+100)},t.prototype.disappearHomePage=function(t,e){egret.Tween.get(t.headerBg).to({y:-183},e),egret.Tween.get(t.headerTitle).to({y:-155},e),egret.Tween.get(t.headerSubTitle).to({y:-111},e),egret.Tween.get(t.headerTip).to({x:-161,y:150},e),egret.Tween.get(t.ringDojo).to({scaleX:0,scaleY:0},e),egret.Tween.get(t.contentDojo).to({scaleX:0,scaleY:0},e),egret.Tween.get(t.contentNewGame).to({scaleX:0,scaleY:0},e),egret.Tween.get(t.ringNewGame).to({scaleX:0,scaleY:0},e),egret.Tween.get(t.contentQuit).to({scaleX:0,scaleY:0},e),egret.Tween.get(t.ringQuit).to({scaleX:0,scaleY:0},e),egret.Tween.get(t.contentTip).to({scaleX:0,scaleY:0},e)},t.prototype.disappearNewGamePage=function(t,e){GameContainer.destroyInstance();egret.Tween.get(t.gameX).to({x:640},e),egret.Tween.get(t.gameXX).to({x:665},e),egret.Tween.get(t.gameXXX).to({x:695},e),egret.Tween.get(t.gameXF).to({x:651},e),egret.Tween.get(t.gameXXF).to({x:678.5},e),egret.Tween.get(t.gameXXXF).to({x:710},e),egret.Tween.get(t.gameScoreIcon).to({x:-65},e),egret.Tween.get(t.gameScore).to({x:-18},e),egret.Tween.get(t.gameBestScore).to({x:-67},e),egret.Tween.get(t.gameover).to({scaleX:0,scaleY:0,alpha:0},e)},t.prototype.disappearJodoPage=function(t,e){egret.Tween.get(t.jodoInfo).to({scaleX:0,scaleY:0},e)},t.prototype.disappearQuitPage=function(t,e){egret.Tween.get(t.quitInfo).to({scaleX:0,scaleY:0},e)},t}();__reflect(SceneManager.prototype,"SceneManager");var BaseScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return void 0===this._instance&&(this._instance=new e),this._instance},e}(eui.Component);__reflect(BaseScene.prototype,"BaseScene");var FruitHomePage=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/eui_skins/eui/HomePage.exml",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addEffects(),this.addEvents(),this.addBgSound()},e.prototype.addEffects=function(){var t=700,e=1e3,i=200,n=300;egret.Tween.get(this.headerBg).to({y:0},t,egret.Ease.circOut),egret.Tween.get(this.headerTitle).to({y:0},t,egret.Ease.circOut);egret.setTimeout(function(){egret.Tween.get(this.headerSubTitle).to({y:40},e,egret.Ease.elasticOut)},this,t),egret.setTimeout(function(){egret.Tween.get(this.headerTip).to({x:0,y:127},i,egret.Ease.circOut)},this,t+e-i),egret.setTimeout(function(){egret.Tween.get(this.ringDojo).to({scaleX:1,scaleY:1},n,egret.Ease.circOut),egret.Tween.get(this.contentDojo).to({scaleX:1,scaleY:1},n,egret.Ease.circOut),egret.Tween.get(this.contentNewGame).to({scaleX:1,scaleY:1},n,egret.Ease.circOut),egret.Tween.get(this.ringNewGame).to({scaleX:1,scaleY:1},n,egret.Ease.circOut),egret.Tween.get(this.contentQuit).to({scaleX:1,scaleY:1},n,egret.Ease.circOut),egret.Tween.get(this.ringQuit).to({scaleX:1,scaleY:1},n,egret.Ease.circOut),egret.Tween.get(this.contentTip).to({scaleX:1,scaleY:1},n,egret.Ease.circOut)},this,t+e),egret.setTimeout(function(){Effects.floatUpdown(this.contentTip,500,!0),Effects.rotate(this.ringDojo,32e3,!0,!1),Effects.rotate(this.contentDojo,24e3,!0,!1),Effects.rotate(this.ringNewGame,3e4,!0,!1),Effects.rotate(this.contentNewGame,15e3,!0,!1),Effects.rotate(this.ringQuit,2e4,!0,!0);var t=new Sparkle(30);t.x=this.contentQuit.x-this.contentQuit.width/2+5,t.y=this.contentQuit.y-this.contentQuit.height/2+5,this.addChild(t)},this,t+e+n)},e.prototype.addEvents=function(){this.contentNewGame.touchEnabled=!0,this.contentNewGame.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Observer.getInstance().fire(Commands.OPEN_NEWGAME)},this),this.contentDojo.touchEnabled=!0,this.contentDojo.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Observer.getInstance().fire(Commands.OPEN_JODO)},this),this.contentQuit.touchEnabled=!0,this.contentQuit.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Observer.getInstance().fire(Commands.OPEN_QUIT)},this)},e.prototype.addBgSound=function(){var t=RES.getRes("menu_mp3");this.channelBg=t.play(0,0)},e.getInstance=function(){return void 0===this._instance&&(this._instance=new e),this._instance},e.destroyInstance=function(){this._instance=void 0},e}(eui.Component);__reflect(FruitHomePage.prototype,"FruitHomePage");var FruitJodoPage=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/eui_skins/eui/JodoPage.exml",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addEffects(),this.addEvents()},e.prototype.addEffects=function(){var t=700;egret.Tween.get(this.jodoInfo).to({scaleX:1,scaleY:1},t,egret.Ease.backOut)},e.prototype.addEvents=function(){this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Observer.getInstance().fire(Commands.CLOSE_JODO)},this)},e.getInstance=function(){return void 0===this._instance&&(this._instance=new e),this._instance},e.destroyInstance=function(){this._instance=void 0},e}(eui.Component);__reflect(FruitJodoPage.prototype,"FruitJodoPage");var FruitNewGamePage=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/eui_skins/eui/NewGamePage.exml",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addEffects(),this.addStartSound(),this.scoreCount=this.failedCount=0,this.gameContainer=GameContainer.getInstance(),this.gameContainer.width=this.width,this.gameContainer.height=this.height,this.addChild(this.gameContainer),this.gameManeger=new GameManager},e.prototype.addEffects=function(){var t=700;egret.Tween.get(this.gameX).to({x:545},t,egret.Ease.backOut),egret.Tween.get(this.gameXX).to({x:570},t,egret.Ease.backOut),egret.Tween.get(this.gameXXX).to({x:600},t,egret.Ease.backOut),egret.Tween.get(this.gameScoreIcon).to({x:11},t,egret.Ease.backOut),egret.Tween.get(this.gameScore).to({x:58},t,egret.Ease.backOut),egret.Tween.get(this.gameBestScore).to({x:9},t,egret.Ease.backOut)},e.prototype.addStartSound=function(){var t=RES.getRes("start_mp3");t.play(0,1)},e.getInstance=function(){return void 0===this._instance&&(this._instance=new e),this._instance},e.destroyInstance=function(){this._instance=void 0},e}(eui.Component);__reflect(FruitNewGamePage.prototype,"FruitNewGamePage");var FruitQuitPage=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/eui_skins/eui/QuitPage.exml",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addEffects(),this.addEvents()},e.prototype.addEffects=function(){var t=700;egret.Tween.get(this.quitInfo).to({scaleX:1,scaleY:1},t,egret.Ease.backOut)},e.prototype.addEvents=function(){this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Observer.getInstance().fire(Commands.CLOSE_QUIT)},this)},e.getInstance=function(){return void 0===this._instance&&(this._instance=new e),this._instance},e.destroyInstance=function(){this._instance=void 0},e}(eui.Component);__reflect(FruitQuitPage.prototype,"FruitQuitPage");